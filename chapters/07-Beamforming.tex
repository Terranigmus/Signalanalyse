\chapter{Beamforming}

Bei Beamforming sucht man die richtige Wellenzahl $\vec{k}$ des Erdbebens, dabei wird die Stappelung von vielen Seismogrammen des gesuchten Bebens durchgeführt. 

Ein Seismogramm $u(x,y,t)$ kann als Funktion des zeitverschobenen Signals und Rauschen dargestellt werden:
\begin{equation}
u(x,y,t) = s(t-t_{j})+m(x_{j},y_{j},t)
\end{equation}
 Dabei ist $s(t-t_{j})$ das zeitverschobene Signal und $m(x_{j},y_{j},t)$ das Rauschen.
 \\
 Durch Summieren über alle Stationen wird ein Beam $b(t)$ erzeugt :
 
 \begin{equation} b(t) = \sum_{j=1}^{n} u( x_{j},y_{j},t+t_{j})\end{equation}
 $j$ ist der Stationindex.
 
 Die Slowness sei bekannt. Für Slowness $\vec{p}$ gilt : $ \vec{p}\approx \hat{\vec{p}}$
 \\ Die Zeitverschiebung ist:  \begin{equation}\hat{t}_{j}=\hat{\vec{p}}\hat{r}\end{equation}
 \\ Alle Seismogramme werden mit einer bestimmten Slowness verschoben. Der Prozess wird für alle Langsamkeiten , $\vec{p}$, durchgeführt. So wird die passende Wellenzahl der ankommenden Wellenfront wird ermittelt. 
 

 \begin{equation}b(t) = M_{s}(t)+ \sum_{j=1}^{n} u( x_{j},y_{j},t+t_{j})\end{equation}
 dabei ist $M_{s}(t)$ die konstruktive Interferenz und \begin{equation*}\sum_{j=1}^{n} u( x_{j},y_{j},t+t_{j})
\end{equation*} die destruktive Interferenz.

\section{Velocity Spectrum Analysis}
Die Richtung der ankommenden Wellenfront sei bekannt, aber der Betrag der Slowness  $\vert\vec{p}\vert$ und die Phasengeschwindigkeit $C_{x}$ seinen unbekannt.
In diesem Fall könnte die Geschwindigkeit-Spektrum-Analyse ( velocity spectrum analysis) durchgeführt werden.

$\vert\hat\vec{p}\vert$ wird systematisch variiert, und jeweils wird ein Beam berechnet.\\
$Stack = f(\vert\hat{\vec{p}}\vert,t)$\\
Alle Hypothesen werden durchprobiert, alle Slowness werden ausprobiert.  Man erstellt ein Vespogramm. 

\section{f-k-Analyse}
In einem Fall. wo Geschwindigkeit und Richtung der Wellenfront unbekannt ist, kann eine Frequenz-Wellenzahl-Analyse durchgeführt werden. Dabei wird eine 3D-Fourier-Transformation durchgeführt:
\begin{equation}
u(k_{x},k_{y},\omega) = \iiint_{-\infty}^{\infty} u(x,y,t)\cdot\exp^{(-i(k_{x}x+k_{y}y+\omega t))} dxdyd\omega
\end{equation}
Modell :
\[
u(x_{j},y_{j},\omega) = S(\omega)\cdot\exp^{(-ik\hat{r})}+N(x_{j},y_{j},\omega)
\]
\\ dabei ist $S(\omega)\cdot\exp({-ik\hat{r}})$ das empfangene Signal und $N(x_{j},y_{j},\omega)$ das Rauschen.  $\vec{r}$ ist der Stationsvektor. Die Hypothese lautet : 
\[
\hat{t_{j}} = \hat{\vec{p}} \vec{r}
\]
Stack im Frequenzbereich für alle mögliche $\vec{k}$.
Statt $u(k_{x}, k_{y}, \omega)$ nehmen wir $FK(\hat{\vec{k}},\omega)$ an.
Dann erhalten wir : \begin{equation} FK(\hat{\vec{k}},\omega) = M S(\omega)+\sum_{j}N(x_{j},y_{j},\omega)
\end{equation}
$k_{y}$- und $k_{x}$-Komponenten werden geplottet. Aus dem Plot wird die der Wellenzahlvektor $\vec{k}$ abgelesen, so zeigt $\vec{k}$ die Richtung der einfallenden Wellenfront. Die Länge des Wellenzahlvektors  ist definiert als:
\begin{equation}
\vec{k} = \vec{n} k = \vec{n} \dfrac{\omega}{c_x} = \vec{n} \omega p= \omega \vec{p} 
\end{equation}
Aus der Richtung und der Länge des Wellenzahlvektors $\vec{k}$ berechnet man dann den Slownessvektor $\vec{p}$.\\
Eine wichtige Rolle bei der f-k-Analyse spielt das Auflösungsvermögen eines Arrays. Die Array-Antwort beschreibt die Auflösungsvermögen einers Arrays. Grosse Fläche des Arrays bedeutet eine hohe Auflösung im Wellenzahlbereich. Dagegen eine kleinere Fläche entspricht einer geringeren Auflösung. Bei einer geringen Stationsdichte entsteht bei f-k-Analyse kein klares Maximum im Wellenzahlbereich.
Modell: Im Ortsbereich nimmt man $u(x_{j},y_{j},t) = \delta(t-t_{j})$ an, das ist $u(x_{j},y_{j},t)= \exp^{-i\omega t_{j}}$ im Frequenzbereich. Mit dem Stationsvektor $\vec{r_{j}}$ ist $u(x_{j},y_{j},t) = \exp^{-i\vec{k}\vec{r_{j}}}$  im Frequenzbereich.
Mit dem Verschiebungssatz folgt :
\begin{equation} FK(\hat{\vec{k}},\omega) = \sum_{j}\exp^{i( \hat{k}-k)\vec{r_{j}}}
\end{equation}
3D-Fourier-Transformation liefert dann eine sinc-Funktion im Wellenzahlbereich. Ein Array, das im Ortsbereich  in x-Richtung gestreckt ist, ergibt eine Ellipse im Wellenzahlbereich. \\
Ein Array, das linear ausgerichtet ist, ist nicht optimal für die Frequenz-Wellenzahl-Analyse. Ein Array, das flächenweise ausgerichtet ist, ergibt sich ein eindeutiges Maximum im Wellenzahlbereich.